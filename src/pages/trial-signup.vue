<template>
    <div>
        <!-- ===================================================================================
        App Meta
        ==================================================================================== -->
        <app-meta 
            :cb-title="'Sign Up - Get Your Free Sandbox - Chargebee'" 
            :cb-desc="'Sign up for Chargebee and make recurring billing, a breeze. Create a free test account to explore all our power packed features. It\'s easy to register.'" 
            :cb-url="'/trial-signup/'" 
            :cb-image="''"
            :cb-style="'/static/website/version/styles/signupv2.css,/static/website/version/styles/intlTelInput.css, https://use.typekit.net/gza3eix.css'"
            :cb-head-script="''"
            :cb-body-script="'/static/website/version/scripts/intlTelInput.js,/static/website/version/scripts/email-validator.js,https://www.google.com/recaptcha/api.js?render=6LdFDa4UAAAAAAAFtnzPB9R4CuxPx9KV3xJBKDnM'"
            :cb-has-noindex="false" />
        <!-- ===================================================================================
        App Meta
        ==================================================================================== -->
        <!-- ===================================================================================
        Main Content
        ==================================================================================== -->
        <div class="cb-body">
            <!-- ===============================================================================
            Signup part 
            ================================================================================ -->
            <div class="cs-signup">
                <div class="cs-signup__container">
                    <!-- =======================================================================
                    Aside part 
                    ======================================================================== -->
                    <div class="cs-signup__aside">
                        <div class="cs-testimonials carousel slide" id="cb-carousel" data-ride='carousel' data-interval="false">
                            <div class="cs-testimonials__body carousel-inner">
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            <div class="cs-testimonial item active">
                                <div class="cs-testimonial__header">
                                    <div class="cs-testimonial__figure">
                                        <img src="/static/website/version/images/signup/customers/dailius-wilson-getaccept.png" alt="Dailius Wilson" class="img-responsive" width="320">
                                    </div>
                                    <div class="cs-testimonial__figcaption">
                                        <div class="cs-testimonial__title">
                                            Dailius Wilson
                                        </div>
                                        <div class="cs-testimonial__desig">
                                            VP Sales & Growth
                                        </div>
                                    </div>
                                </div>
                                <div class="cs-testimonial__content">
                                    <div class="cs-testimonial__desc">
                                        Chargebee is a fantastic solution that really meets the needs of any SaaS business. Our revenue grew 4x in 12 months, using Chargebee.
                                    </div>
                                    <div class="cs-testimonial__icon">
                                        <img src="/static/website/version/images/signup/customers/get-accept-logo.svg" width="150" alt="getaccept" class="img-responsive">
                                    </div>
                                    <!-- <div class="cs-testimonial__highlight">
                                        Built For Hyper-growth
                                    </div> -->
                                </div>
                            </div>
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            <div class="cs-testimonial item">
                                <div class="cs-testimonial__header">
                                    <div class="cs-testimonial__figure">
                                        <img src="/static/website/version/images/signup/customers/gilles-bertaux-livestorm.png" alt="Gilles Bertaux" class="img-responsive" width="320">
                                    </div>
                                    <div class="cs-testimonial__figcaption">
                                        <div class="cs-testimonial__title">
                                            Gilles Bertaux
                                        </div>
                                        <div class="cs-testimonial__desig">
                                            Co-founder & CEO
                                        </div>
                                    </div>
                                </div>
                                <div class="cs-testimonial__content">
                                    <div class="cs-testimonial__desc">
                                        Using Chargebee is also one less area we have to worry about as we scale. We know that it’ll adapt to most if not any situations that’ll come up in the future.
                                    </div>
                                    <div class="cs-testimonial__icon">
                                        <img src="/static/website/version/images/signup/customers/livestorm-logo.svg" alt="Livestorm" class="img-responsive">
                                    </div>
                                    <!-- <div class="cs-testimonial__highlight">
                                        One-stop Solution
                                    </div> -->
                                </div>
                            </div>
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            <div class="cs-testimonial item">
                                <div class="cs-testimonial__header">
                                    <div class="cs-testimonial__figure">
                                        <img src="/static/website/version/images/signup/customers/justin-garcia-inspirecio.png" alt="Justin Garcia" class="img-responsive" width="320">
                                    </div>
                                    <div class="cs-testimonial__figcaption">
                                        <div class="cs-testimonial__title">
                                            Justin Garcia 
                                        </div>
                                        <div class="cs-testimonial__desig">
                                            Dir. of Technology
                                        </div>
                                    </div>
                                </div>
                                <div class="cs-testimonial__content">
                                    <div class="cs-testimonial__desc">
                                        Our org went live with Chargebee a week ago and man, I cannot say enough good things about their system and their support. Well worth the price.
                                    </div>
                                    <div class="cs-testimonial__icon">
                                        <img src="/static/website/version/images/signup/customers/inspirecio-logo.svg" alt="Inspirecio" class="img-responsive">
                                    </div>
                                    <!-- <div class="cs-testimonial__highlight">
                                        Customer-centric Approach
                                    </div> -->
                                </div>
                            </div>
                            <!-- ===============================================================
                            Testimonial one part 
                            ================================================================ -->
                            </div>
                            <div class="cs-testimonials__footer">
                                <div class="cs-testimonials__actions carousel-indicators">
                                    <div data-target="#cb-carousel" data-slide-to="0" class="cs-testimonials__action active">
                                        <span>
                                            Built For Hyper-growth
                                        </span>
                                    </div>
                                    <div data-target="#cb-carousel" data-slide-to="1" class="cs-testimonials__action">
                                        <span>
                                            One-stop Solution
                                        </span>
                                    </div>
                                    <div data-target="#cb-carousel" data-slide-to="2" class="cs-testimonials__action">
                                        <span>
                                            Customer-centric Approach
                                        </span>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- =======================================================================
                    Aside part 
                    ======================================================================== -->
                    <!-- =======================================================================
                    Main part 
                    ======================================================================== -->
                    <div class="cs-signup__main">
                        <div class="cs-main">
                            <!-- ===============================================================
                            Main Header Part 
                            ================================================================ -->
                            <div class="cs-main__header">
                                <div class="cs-main__logo hidden-xs" style="font-size: 0;">
                                   <a href="/" style="display: inline-block">
                                        <img src="/static/resources/brand/chargebee-logo-black.svg" alt="Chargebee Logo" class="img-responsive">
                                   </a>
                                </div>
                                <div class="visible-xs">
                                    <div class="cs-main__icon">
                                        <img src="/static/resources/brand/chargebee-icon-white.svg" alt="Chargebee Logo" class="img-responsive" height="32">
                                    </div>
                                </div>



                                <div class="cs-main__action hidden-xs">
                                    <!-- <span class="cs-main__desc">Already have an Account?</span> -->
                                    <a href="https://app.chargebee.com/login" class="cs-link cs-link--icon">Login</a>
                                </div>
                            </div>
                            <!-- ===============================================================
                            Main Header Part 
                            ================================================================ -->
                            <!-- ===============================================================
                            Main Content Part 
                            ================================================================ -->
                            <div class="cs-main__content">
                                <div class="cs-form">
                                    <div class="cs-form__title">
                                        Create Your Sandbox Account
                                    </div>
                                    <form id="users_create" name="users_create" method="post" v-bind:action="formAction" autocomplete="on" data-users-create-new="true">
                                        <!-- ================================================================
                                        Form part start 
                                        ================================================================= -->
                                        <div class="cs-form__group">
                                            <div class="cs-form__label">Work email</div>
                                            <div class="cs-form__field">
                                                <input type="text" class="cs-form__control" placeholder="(eg) john.m@company.com" id="user.email" name="user.email" autofocus="true" autocomplete="off" value="" validate="true">
                                                <span id="user.email-err" class="cs-form__error"></span>
                                                <span id="user.email-success" class="cs-form__success"></span>
                                            </div>
                                        </div>

                                        <!-- ================================================================
                                        Form phone number field start 
                                        ================================================================= -->
                                        <div class="cs-form__group">
                                            <div class="cs-form__label">Phone number</div>
                                            <div class="cs-form__field">
                                                <input type="hidden" id="phone_no" name="phone_no">
                                                <input type="hidden" id="recaptcha_token" name="recaptcha_token">
                                                <input type="hidden" id="currency_code" name="currency_code" v-bind:value="currencyCode">
                                                <input type="tel" class="cs-form__control" id="user.phone" autofocus="true" autocomplete="off" value="" validate="true">
                                                <span id="user.phone-err" class="cs-form__error"></span>
                                                <span id="user.phone-success" class="cs-form__success"></span>
                                            </div>
                                        </div>
                                        <!-- ================================================================
                                        Accept Terms and Conditions
                                        ================================================================= -->
                                        <div class="cs-form__group" style="margin-bottom: 16px;">
                                            <div class="cs-checkbox" id="accept-terms-container">
                                                <label class="cs-checkbox__label" id="cb-accept-terms" style="font-size: 14px;">
                                                    <input id="consent_accepted" name="consent_accepted" type="checkbox" class="cs-checkbox__element" value="true">
                                                    <span class="cs-checkbox__value">
                                                        I want to be notified about the awesome happenings<sup>*</sup> at Chargebee
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- ================================================================
                                        Accept Terms and Conditions
                                        ================================================================= -->
                                        <div class="cs-form__actions" style="display: block;">
                                            <div class="cs-form__action">
                                                <div class="cs-form__field">
                                                    <input id="sign-up-submit" type="submit" value="Complete Signup →" class="cs-form__btn" onclick="ga('send', 'event', 'website', 'signup-action', 'button-signup');" disabled>
                                                </div>
                                                <!-- ================================================================
                                                Form part start 
                                                ================================================================= -->
                                                <!-- <div class="cs-form__group cs-form__group--grid">
                                                    <label class="cs-form__label" for="region">Your data hosting is </label>
                                                    <div class="cs-form__field">
                                                        <select id="region" name="region" class="form-control" @change="changeFormAction($event)" v-model="region">
                                                            <option value="US">US Region</option>
                                                            <option value="EU">EU Region</option>
                                                        </select>
                                                    </div>
                                                </div> -->

                                                <!-- ================================================================
                                                Accept Terms and Conditions
                                                ================================================================= -->
                                                <div class="cs-form__group" style="margin-top: 40px; margin-bottom: 12px; font-size: 13px; color: #7f7f7f;">
                                                    By clicking on Complete Signup, you agree to our <a href="/company/terms/" target="_blank" style="color: #00000A; text-decoration: none;">Terms</a> and you acknowledge having read our <a href="/privacy/" target="_blank" style="color: #00000A; text-decoration: none;">Privacy Notice</a>
                                                </div>

                                                <div class="cs-form__group" style="font-size: 11px; margin-bottom: 0; color: #9f9ca6;">
                                                    <sup>*</sup>This includes periodic newsletters, emails about usage tips, billing practices, and other communications. You can opt out anytime within the app.
                                                </div>
                                                <!-- ================================================================
                                                Accept Terms and Conditions
                                                ================================================================= -->
                                            </div>
                                        </div>
                                        <!-- ================================================================
                                        Form part end 
                                        ================================================================= -->
                                        <!-- <input type='hidden' name="cf_business_type" value="saas" /> -->
                                        <input type='hidden' name="cb_signedup_plan" value="" />
                                        <input type='hidden' name="cf_adwords_keyword" value="" />
                                        <input type='hidden' name="cf_adwords_campaign_id" value="" />
                                        <input type='hidden' name="cf_hubspotutk" id="cf_hubspotutk"  value="" />
                                        <input type='hidden' name="client_id" value="" />
                                    </form>
                                </div>
                            </div>
                            <!-- ===============================================================
                            Main Content Part 
                            ================================================================ -->
                            <!-- ===============================================================
                            Main Footer Part 
                            ================================================================ -->
                            <div class="cs-main__footer hidden-xs">
                                <img src="/static/website/version/images/signup/customers/chargebee-customers.svg" alt="Chargebee Customers" class="img-responsive" width="480" style="margin: auto">
                            </div>
                            <!-- ===============================================================
                            Main Footer Part 
                            ================================================================ -->
                        </div>
                    </div>
                    <!-- =======================================================================
                    Main part 
                    ======================================================================== -->
                </div>
            </div>
            <!-- ===============================================================================
            Signup part 
            ================================================================================ -->
            <!-- ===============================================================================
            Cookie Banner
            ================================================================================ -->
            <cookie-banner />
            <!-- ===============================================================================
            Cookie Banner
            ================================================================================ -->
        </div>
        <!-- ===================================================================================
        Main Content
        ==================================================================================== -->
    </div>
</template>
<!-- ===================================================================================
Page Level Scripts
==================================================================================== -->
<script>
    import AppMeta from '~/components/AppMeta.vue';
    import AppHeader from '~/components/AppHeader.vue';
    import cookieBanner from '~/components/cookieBanner.vue';
    const axios = require('axios');
    
    export default {
        components: {
            'app-meta': AppMeta,
            'app-header': AppHeader,
            'cookie-banner': cookieBanner
        },
        data() {
            return {
                currencyCode: 'USD',
                region: 'US',
                formAction: 'https://app.chargebee.com/users/create'
            }
        },
        methods: {
            changeFormAction(event){
                var regionValue = event.target.value;
                this.formAction = regionValue == 'US' ? 'https://app.chargebee.com/users/create' : 'https://app.eu.chargebee.com/users/create'
                // console.log(regionValue+"<==>"+this.formAction)
            }
        },
        mounted() {
            let initialData = this
            axios.get('https://freegeoip.live/json/')
            .then(function (response) {
                let countryCode = response.data.country_code;
                
                let geoCountry = response.data.country_name;
                sessionStorage.setItem("geoCountry", geoCountry);
                
                var euroCountryList = ['CY','GR','EE','LV','LT','SJ','MD','BY','FI','AX','UA','MK','HU','BG','AL','PL','RO','XK','RU','PT','GI','ES','MT','FO','DK','IS','CH','SE','NL','AT','BE','DE','LU','IE','MC','FR','AD','LI','JE','IM','GG','SK','CZ','NO','VA','SM','IT','SI','ME','HR','BA','RS']
                if(euroCountryList.indexOf(''+countryCode+'') > -1){
                    initialData.currencyCode = 'EUR',
                    initialData.region = 'EU'
                    // initialData.formAction = 'https://app.eu.chargebee.com/users/create'
                }
                if(countryCode == 'GB'){
                    initialData.currencyCode = 'GBP'
                }
                if(countryCode == 'AU'){
                    initialData.currencyCode = 'AUD'
                }
                if(countryCode == 'CA'){
                    initialData.currencyCode = 'CAD'
                }
            })
            var getParameterByName = function(name, url) {
                if (!url) url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                    results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }
            //material button animation
            $('.cs-panel').mousedown(function(e) {
                var target = e.target;
                var rect = target.getBoundingClientRect();
                var ripple = target.querySelector('.ripple');
                $(ripple).remove();
                ripple = document.createElement('span');
                ripple.className = 'ripple';
                ripple.style.height = ripple.style.width = Math.max(rect.width, rect.height) + 'px';
                target.appendChild(ripple);
                var top = e.pageY - rect.top - ripple.offsetHeight / 2 - document.body.scrollTop;
                var left = e.pageX - rect.left - ripple.offsetWidth / 2 - document.body.scrollLeft;
                ripple.style.top = top + 'px';
                ripple.style.left = left + 'px';
                return false;
            });

            //Onclick active
            $('.cs-panel').click(function() {
                $(this).toggleClass('cs-panel--active').siblings().removeClass('cs-panel--active');
            });
            var isValidPhoneNumber = false;
            var isValidWebsite = false;
            var isValidEmail = false;
            // load and set site locale
            $.ajax({
                url: "https://merchant-test.chargebee.com/users/extract_locale",
                jsonp: "_jsapi_callback",
                dataType: "jsonp",
                success: function(data) {
                    window.site_locale = data;
                }
            });
            var userEmail = getParameterByName("user\\\.email");
            if (userEmail) {
                $("input[name='user.email']").val(userEmail);
            }

            // var businessType = getParameterByName("cf_business_type");
            // if (businessType) {
            //     $("input[type='radio'][name='cb-business-type'][value='" + businessType + "']").attr('checked', 'checked');
            //     $("input[name='cf_business_type']").val(businessType);
            // }

            var couponCode = getParameterByName("cb_coupon_code");
            if (couponCode && couponCode.trim()) {
                jQuery('<input>').attr({
                    type: 'hidden',
                    id: 'cb_coupon_code',
                    name: 'cb_coupon_code',
                    value: couponCode
                }).appendTo(jQuery("#users_create"));
            }
            $('.cb-io-biz-box').click(function() {
                $('.cb-io-signup').removeClass('cb-io-signup-alt-active');
                $('.cb-io-signup-box label span').html("Just your email address and <br> we're good to go…");
                $('.cb-io-signup').toggleClass('cb-io-signup-active');
                $(this).toggleClass('cb-io-biz-box-active');
                if ($('.cb-io-signup').hasClass('cb-io-signup-active')) {
                    $(".trial-input").focus();
                }
                $("span[name*='err']").text("");
            });

            $('.cb-io-biz-box,.cb-io-signup-toggle').click(function() {
                $("input[name='cf_business_type']").val($(this).attr("cb-business-type"));
                var btypega = "btype-sel-" + $(this).attr("cb-business-type");
                ga('send', 'event', 'website', 'signup-intent', btypega);
            });

            // var setBusinessTypeAndSendGa = function(businessType) {
            //     $("input[name='cf_business_type']").val(businessType);
            //     sessionStorage.setItem("bt", businessType);
            //     var btypega = "btype-sel-" + businessType;
            //     ga('send', 'event', 'website', 'signup-intent', btypega);
            // }

            // $('[cb-business-type-container]').click(function() {
            //     setBusinessTypeAndSendGa($(this).attr("cb-business-type"));
            // });

            // $('#business-type-no').change(function() {
            //     $('[cb-business-type-container]').removeClass('cs-panel--active');
            //     if ($(this).is(':checked')) {
            //         setBusinessTypeAndSendGa($(this).attr("cb-business-type"));
            //         $('#business-type-container').addClass('cs-panels--disabled')
            //     } else {
            //         $("input[name='cf_business_type']").val('');
            //         $('#business-type-container').removeClass('cs-panels--disabled')
            //     }
            // });

            // $("input[type='radio'][name='cb-business-type']").change(function() {
            //     setBusinessTypeAndSendGa($(this).val());
            // });


            $('.cb-io-biz-skip').click(function() {
                $('.cb-io-signup').removeClass('cb-io-signup-active');
                $('.cb-io-signup-box label span').html("Just your email address and <br> we're good to go…");
                $('.cb-io-signup').toggleClass('cb-io-signup-alt-active');
                if ($('.cb-io-signup').hasClass('cb-io-signup-alt-active')) {
                    $(".trial-input").focus();
                    $(this).text('Go Back');
                } else {
                    $(this).text("I don't fit into any of this");
                }
            });

            function getPlanName(name, url) {
                if (!url) url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                    results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }
            var plan = getPlanName('plan');
            $("input[name='cb_signedup_plan']").val(plan);

            var adkeyword = $.cookie('keyword');
            var decadkeyword = decodeURIComponent(adkeyword);
            var adcampaignid = $.cookie('campaignid');
            if (adcampaignid && adkeyword) {
                $("input[name='cf_adwords_keyword']").val(decadkeyword);
                $("input[name='cf_adwords_campaign_id']").val(adcampaignid);
            }

            $('.trial-submit, #sign-up-submit').click(function(event) {
                $.removeCookie('keyword');
                $.removeCookie('campaignid');
                sessionStorage.removeItem("bt");
                sessionStorage.removeItem("rc");
                event.preventDefault();
                grecaptcha.execute('6LdFDa4UAAAAAAAFtnzPB9R4CuxPx9KV3xJBKDnM', {action: 'signup'}).then(function(token) {
                    $('#recaptcha_token').val(token);
                    var user_email = $("#user\\\.email").val() ? $("#user\\\.email").val() : '';
                    var user_mobile = $("#phone_no").val() ? $("#phone_no").val() : '';
                    sessionStorage.setItem("user_email", user_email);
                    sessionStorage.setItem("user_mobile", user_mobile);
                    $('[data-users-create-new="true"]').submit();
                });
            });
            
            // For Hubspot
            var hubspotutk_val = $.cookie('hubspotutk');
            if(hubspotutk_val && hubspotutk_val !=''){
                $('#cf_hubspotutk').val(hubspotutk_val);
            }

            var enableUserCreateSubmit = function() {
                if ( isValidEmail && isValidPhoneNumber ) {
                    $('#sign-up-submit').removeAttr('disabled');
                } else {
                    $('#sign-up-submit').attr('disabled', 'disabled');
                }
            };

            // function isBusinessEmail(userEmail){
            //     if(isFreeEmail(userEmail) && $('#user\\\.website').val().trim() == ''){
            //         isValidWebsite = false;
            //     }else{
            //         isValidWebsite = true;
            //     }
            // }

            var emailFieldErr = $('#users_create').find('#user\\\.email-err');
            var emailReg = /[a-zA-Z0-9!#$%&'*+//=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+//=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?/;
            function emailValidation(userEmail,eventType){
                if (userEmail === '') {
                    if(eventType === "change"){
                        $(emailFieldErr).html('Please enter a valid email. We don&rsquo;t spam.');
                    }else{
                        $(emailFieldErr).html('');
                    }
                    isValidEmail = false;
                } else if (emailReg.test(userEmail)) {
                    if(isFreeEmail(userEmail.toLowerCase())){
                        $(emailFieldErr).html("Please enter your business email. Don’t have one? <a id=\"email_validation\" href=\"javascript:void(0)\">Chat with us now</a>");
                        // $("#user\\\.email").blur();
                        $("#email_validation").on('click', function(){
                            drift.api.startInteraction({ interactionId: 111909 });
                        });
                        isValidEmail = false;
                    }else{
                        isValidEmail = true;
                        $(emailFieldErr).text('');
                    }
                } else {
                    if(eventType === "change"){
                        $(emailFieldErr).html('Please enter a valid email address.');
                    }else{
                        $(emailFieldErr).html('');
                    }
                    isValidEmail = false;
                }
            }

            $('#user\\\.email').on('keyup change', function(e) {
                var userEmail = $(this).val();
                emailValidation(userEmail,e.type)
                //isBusinessEmail(userEmail)
                enableUserCreateSubmit();
            });

            // $('#user\\\.website').on('keyup', function() {
            //     if($(this).val().trim()){
            //         isValidWebsite = true;
            //     }else{
            //         var userEmail = $('#user\\\.email').val();
            //         isBusinessEmail(userEmail)
            //     }
            //     enableUserCreateSubmit();
            // });
            // $('input[name="cb-business-type"]').on('change', function() {
            //     enableUserCreateSubmit();
            // });
            // $('[cb-business-type]').click(function() {
            //     enableUserCreateSubmit();
            // });
            
            let bt = sessionStorage.getItem("bt");
            let rc = sessionStorage.getItem("rc");
            if(bt == null) {
                bt = "";
            }
            if(rc == null) {
                rc = "";
            }
            //$('input[name="cb-business-type"][value="'+bt+'"]').prop("checked", true).trigger("change");
            
            /********* Phone Number Validation **********/
            var input = document.querySelector("#user\\\.phone");
            var iti = window.intlTelInput(input, {
                initialCountry: "auto",
                geoIpLookup: function(callback) {
                    $.get('https://freegeoip.live/json/').always(function(resp) {
                        var countryCode = (resp && resp.country_code) ? resp.country_code : "US";
                        callback(countryCode);
                    });
                },
                separateDialCode: true,
                preferredCountries: ['us', 'gb', 'au', 'ca'],
                utilsScript: "/static/website/version/scripts/utils.js",
            });

            var errorMsg = document.querySelector("#user\\\.phone-err"),
            validMsg = document.querySelector("#user\\\.phone-success");

            // error messages
            var errorMap = [ "Please enter a valid phone number.", "Invalid country code", "", "Too long", "Please enter a valid phone number."];

            var reset = function() {
                input.classList.remove("error");
                errorMsg.innerHTML = "";
                errorMsg.classList.add("hide");
                validMsg.classList.add("hide");
            };
            
            // keyup, blur: validate
            var phoneNoVal, countryCodeVal;
            $(input).on('keyup blur', function() {
                reset();
                if (input.value.trim()) {
                    if (iti.isValidNumber()) {
                        isValidPhoneNumber = true;
                        enableUserCreateSubmit();
                        validMsg.classList.remove("hide");
                    } else {
                        isValidPhoneNumber = false;
                        enableUserCreateSubmit();
                        input.classList.add("error");
                        var errorCode = iti.getValidationError();
                        if(errorCode != -99){
                            errorMsg.innerHTML = errorMap[errorCode];
                        }
                        errorMsg.classList.remove("hide");
                    }
                }else{
                    isValidPhoneNumber = false;
                    enableUserCreateSubmit();
                }
                phoneNoVal = $(this).val();
                countryCodeVal = $('.iti .iti__selected-dial-code').text();
                $('#phone_no').val(countryCodeVal + phoneNoVal);
            });
            ga(function(tracker) {
                var clientId = tracker.get('clientId');
                $("input[name='client_id']").val(clientId);
            });
            // For Signup Thankyou Page
            // axios.get('https://reveal.clearbit.com/v1/companies/reveal?authorization=pk_df70c67c148371c07dceee61f0c496d8')
            // .then(function (response) {
            //     var company = response.data.company
            //     if(company){
            //         sessionStorage.setItem("revealData_name", company.name ? company.name : '');
            //         sessionStorage.setItem("revealData_tags", company.tags ? company.tags.includes("SAAS") ? 'SAAS' : '' : '');
            //         if(company.metrics){
            //             sessionStorage.setItem("revealData_employeesRange", company.metrics.employeesRange ? company.metrics.employeesRange : '');
            //             sessionStorage.setItem("revealData_employees", company.metrics.employees ? company.metrics.employees : '');
            //             sessionStorage.setItem("revealData_estimatedAnnualRevenue", company.metrics.estimatedAnnualRevenue ? company.metrics.estimatedAnnualRevenue : '');
            //         }
            //         if(company.geo){
            //             sessionStorage.setItem("revealData_country", company.geo.country ? company.geo.country : '');
            //         }
            //     }
            // })
        }
    }
</script>
<!-- ===================================================================================
Page Level Scripts
==================================================================================== -->
